# Wagent - Web-Agent Bridge for ChatGPT

![Version](https://img.shields.io/badge/version-0.1.0-blue)
![Python](https://img.shields.io/badge/python-3.10+-green)
![License](https://img.shields.io/badge/license-MIT-yellow)

**Wagent**ã¯Webç‰ˆChatGPTã‚’ã€ŒAPIã€ã®ã‚ˆã†ã«æ‰±ã„ã€è‡ªä½œã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰å‘¼ã³å‡ºã™ãŸã‚ã®ãƒ–ãƒªãƒƒã‚¸ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ğŸ¯ æ¦‚è¦

Playwrightã«ã‚ˆã‚‹ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–æŠ€è¡“ã‚’é§†ä½¿ã—ã¦ã€Web UIã®èƒŒå¾Œã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç¶­æŒã—ã€å‘½ä»¤ã®ä¸­ç¶™ã‚’è¡Œã†ã€Œãƒ—ãƒ­ã‚­ã‚·ãƒ»ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

```mermaid
flowchart LR
    Agent["Agent<br/>(Client)"]
    Wagent["Wagent<br/>Server"]
    ChatGPT["ChatGPT<br/>Web UI"]

    Agent <-->|HTTP / REST| Wagent
    Wagent <-->|Playwright| ChatGPT

```

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### 1. ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install -r requirements.txt
```

### 2. Playwrightãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
playwright install chromium
```

## ğŸš€ ä½¿ã„æ–¹

### å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆåˆå›ãƒ­ã‚°ã‚¤ãƒ³ç”¨ï¼‰

åˆå›ã¯ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ãã€ChatGPTã«æ‰‹å‹•ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```bash
python -m wagent.main --interactive
```

1. ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™
2. ChatGPTã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„
3. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§Enterã‚’æŠ¼ã™ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ãŒé–‹å§‹
4. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãƒ†ã‚¹ãƒˆ

### APIã‚µãƒ¼ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰

ãƒ­ã‚°ã‚¤ãƒ³å¾Œã¯ã€APIã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦èµ·å‹•ã§ãã¾ã™ï¼š

```bash
python -m wagent.main --server
```

ã¾ãŸã¯

```bash
python -m wagent.main --server --host 0.0.0.0 --port 8765
```

## ğŸ“¡ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| `POST` | `/v1/chat` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€å›ç­”ã‚’å¾…æ©Ÿã—ã¦è¿”ã™ |
| `GET` | `/v1/status` | ãƒ–ãƒ©ã‚¦ã‚¶ç”Ÿå­˜ç¢ºèªã¨ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ |
| `DELETE` | `/v1/session` | æ–°ã—ã„ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹ï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆï¼‰ |
| `GET` | `/v1/screenshot` | ãƒ‡ãƒãƒƒã‚°ç”¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ |
| `GET` | `/health` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹

```bash
# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
curl -X POST http://127.0.0.1:8765/v1/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Hello, ChatGPT!", "new_conversation": false}'

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
curl http://127.0.0.1:8765/v1/status

# ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
curl -X DELETE http://127.0.0.1:8765/v1/session
```

## ğŸ Pythonã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

```python
from wagent.client import WagentClient, ask_chatgpt

# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨
client = WagentClient()

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
status = client.status()
print(f"Logged in: {status['logged_in']}")

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
response = client.chat("Pythonã§ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã‚’è¨ˆç®—ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„")
print(response["message"])

# æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ã—ã¦ã‹ã‚‰è³ªå•
response = client.chat("åˆ¥ã®ãƒˆãƒ”ãƒƒã‚¯ã§ã™", new_conversation=True)

# ãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆé–¢æ•°
answer = ask_chatgpt("1+1ã¯?")
print(answer)
```

## âš™ï¸ è¨­å®š

### config/settings.yaml

```yaml
browser:
  headless: false  # ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰
  user_data_dir: "./browser_data"  # ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ä¿å­˜

rate_limit:
  requests_per_minute: 10  # 1åˆ†ã‚ãŸã‚Šã®æœ€å¤§ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  min_interval: 3  # ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–“ã®æœ€å°é–“éš”ï¼ˆç§’ï¼‰
```

### config/selectors.yaml

Web UIã®HTMLæ§‹é€ ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€ã“ã“ã®ã‚»ãƒ¬ã‚¯ã‚¿ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
Wagent/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ settings.yaml     # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
â”‚   â””â”€â”€ selectors.yaml    # CSSã‚»ãƒ¬ã‚¯ã‚¿ï¼ˆä¿å®ˆç”¨ï¼‰
â”œâ”€â”€ wagent/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ browser.py        # ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
â”‚   â”œâ”€â”€ client.py         # APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ config.py         # è¨­å®šãƒ­ãƒ¼ãƒ€ãƒ¼
â”‚   â”œâ”€â”€ main.py           # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ schemas.py        # APIã‚¹ã‚­ãƒ¼ãƒ
â”‚   â””â”€â”€ server.py         # FastAPIã‚µãƒ¼ãƒãƒ¼
â”œâ”€â”€ browser_data/         # ãƒ–ãƒ©ã‚¦ã‚¶ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜
â”œâ”€â”€ logs/                 # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ screenshots/          # ãƒ‡ãƒãƒƒã‚°ç”¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## âš ï¸ æ³¨æ„äº‹é …

1. **åˆ©ç”¨è¦ç´„**: Web UIã®è‡ªå‹•æ“ä½œã¯OpenAIã®åˆ©ç”¨è¦ç´„ã«æŠµè§¦ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚å€‹äººåˆ©ç”¨ã®ç¯„å›²ã«ç•™ã‚ã€éåº¦ãªè² è·ã‚’ã‹ã‘ãªã„ã§ãã ã•ã„ã€‚

2. **ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆ**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§1åˆ†ã‚ãŸã‚Š10ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«åˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚

3. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒ**: `browser_data` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚å…±æœ‰ã—ãªã„ã§ãã ã•ã„ã€‚

## ğŸ“œ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
